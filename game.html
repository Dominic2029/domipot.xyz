<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Master - Number Recall Challenge</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        danger: '#EF4444',
                        warning: '#F59E0B',
                        dark: '#1E293B',
                        light: '#F8FAFC'
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .card-flip {
                transform-style: preserve-3d;
                transition: transform 0.6s;
            }
            .card-flip.flipped {
                transform: rotateY(180deg);
            }
            .countdown-pulse {
                animation: pulse 1s infinite alternate;
            }
            @keyframes pulse {
                from { transform: scale(1); opacity: 1; }
                to { transform: scale(1.05); opacity: 0.8; }
            }
            .slide-in {
                animation: slideIn 0.5s ease-out forwards;
            }
            @keyframes slideIn {
                from { transform: translateY(20px); opacity: 0; }
                to { transform: translateY(0); opacity: 1; }
            }
            .fade-in {
                animation: fadeIn 0.5s ease-out forwards;
            }
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            .bounce-in {
                animation: bounceIn 0.6s cubic-bezier(0.215, 0.610, 0.355, 1.000) forwards;
            }
            @keyframes bounceIn {
                0% { transform: scale(0.3); opacity: 0; }
                20% { transform: scale(1.1); }
                40% { transform: scale(0.9); }
                60% { transform: scale(1.03); opacity: 1; }
                80% { transform: scale(0.97); }
                100% { transform: scale(1); opacity: 1; }
            }
        }
    </style>
</head>
<body class="font-inter bg-gradient-to-br from-light to-blue-50 min-h-screen flex flex-col overflow-hidden">
    <!-- Full screen container -->
    <div class="flex-1 flex flex-col relative">
        <!-- Game Header -->
        <header class="bg-white/80 backdrop-blur-sm shadow-sm py-3 px-4 md:px-8">
            <div class="container mx-auto flex justify-between items-center">
                <h1 class="text-[clamp(1.2rem,3vw,1.8rem)] font-bold text-primary flex items-center">
                    <i class="fa fa-brain mr-2 text-primary/80"></i>
                    <span>Memory Master</span>
                </h1>
                <div id="score-display" class="text-dark/80 font-semibold text-lg hidden">
                    Score: <span id="current-score">0</span>/1050
                </div>
            </div>
        </header>

        <!-- Level indicators (20 levels) -->
        <div id="level-indicators" class="py-3 px-4 md:px-8 hidden">
            <div class="container mx-auto flex gap-1 justify-center">
                <!-- Levels will be generated by JS -->
            </div>
        </div>

        <!-- Main Game Area -->
        <main class="flex-1 flex flex-col items-center justify-center p-4 md:p-8 relative">
            <!-- Start Screen -->
            <div id="start-screen" class="max-w-2xl w-full bg-white rounded-2xl shadow-xl p-6 md:p-8 text-center bounce-in">
                <h2 class="text-[clamp(1.5rem,4vw,2.5rem)] font-bold text-primary mb-4 text-shadow">Number Recall Challenge</h2>
                
                <div class="mb-8 text-left space-y-3 text-dark/80">
                    <h3 class="font-semibold text-lg text-dark border-b pb-2">How to play:</h3>
                    <p><i class="fa fa-check-circle text-secondary mr-2"></i> There are 20 levels in total</p>
                    <p><i class="fa fa-check-circle text-secondary mr-2"></i> Each level shows a number for 5 seconds</p>
                    <p><i class="fa fa-check-circle text-secondary mr-2"></i> Level 1 shows 1 digit, Level 2 shows 2 digits, up to 20 digits</p>
                    <p><i class="fa fa-check-circle text-secondary mr-2"></i> Remember the number and enter it correctly after the countdown</p>
                    <p><i class="fa fa-check-circle text-secondary mr-2"></i> Level 1 is worth 5 points, Level 2 is 10 points, up to 100 points for Level 20</p>
                    <p><i class="fa fa-check-circle text-secondary mr-2"></i> Score 840+ for an Excellent rating!</p>
                </div>
                
                <button id="start-button" class="bg-primary hover:bg-primary/90 text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary/50">
                    Start Challenge <i class="fa fa-play ml-2"></i>
                </button>
            </div>

            <!-- Game Screen -->
            <div id="game-screen" class="max-w-2xl w-full flex flex-col items-center hidden">
                <div id="level-display" class="text-dark/70 font-medium mb-2">
                    Level <span id="current-level">1</span>/20
                </div>
                
                <div id="countdown" class="text-warning text-2xl font-bold mb-6 hidden countdown-pulse">
                    5
                </div>
                
                <div id="number-display" class="text-[clamp(2rem,8vw,5rem)] font-bold text-dark mb-8 min-h-[100px] flex items-center justify-center transition-all duration-300">
                    <!-- Number will be displayed here -->
                </div>
                
                <div id="input-area" class="w-full max-w-md hidden fade-in">
                    <input type="text" id="number-input" 
                        class="w-full px-4 py-3 text-xl border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent mb-4 transition-all"
                        placeholder="Enter the number you saw..." 
                        inputmode="numeric" 
                        pattern="[0-9]*">
                    
                    <button id="submit-button" class="w-full bg-primary hover:bg-primary/90 text-white font-bold py-3 px-4 rounded-lg shadow hover:shadow-md transform hover:-translate-y-0.5 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary/50">
                        Submit <i class="fa fa-arrow-right ml-1"></i>
                    </button>
                </div>
                
                <div id="feedback" class="mt-6 text-center hidden slide-in">
                    <!-- Feedback will be displayed here -->
                </div>
                
                <button id="next-button" class="mt-6 bg-secondary hover:bg-secondary/90 text-white font-bold py-2 px-6 rounded-lg shadow hover:shadow-md transform hover:-translate-y-0.5 transition-all duration-300 focus:outline-none hidden slide-in">
                    Next Level <i class="fa fa-chevron-right ml-1"></i>
                </button>
            </div>

            <!-- End Screen -->
            <div id="end-screen" class="max-w-2xl w-full bg-white rounded-2xl shadow-xl p-6 md:p-8 text-center hidden bounce-in">
                <h2 class="text-[clamp(1.5rem,4vw,2.5rem)] font-bold text-primary mb-2 text-shadow">Challenge Complete!</h2>
                
                <div class="mb-6">
                    <div class="text-4xl font-bold text-dark mb-1">Your Score</div>
                    <div class="text-[clamp(2rem,6vw,4rem)] font-bold text-primary" id="final-score">0</div>
                    <div class="text-lg text-dark/70">out of 1050</div>
                </div>
                
                <div class="mb-8 py-4 px-6 rounded-xl" id="rating-container">
                    <div class="text-xl font-semibold" id="rating-text">Good Job!</div>
                </div>
                
                <div class="space-y-3">
                    <button id="restart-button" class="w-full bg-primary hover:bg-primary/90 text-white font-bold py-3 px-4 rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary/50">
                        Play Again <i class="fa fa-refresh ml-2"></i>
                    </button>
                    
                    <button id="home-button" class="w-full bg-gray-200 hover:bg-gray-300 text-dark font-bold py-3 px-4 rounded-lg shadow hover:shadow-md transform hover:-translate-y-1 transition-all duration-300 focus:outline-none">
                        Return to Home <i class="fa fa-home ml-2"></i>
                    </button>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-dark/5 py-3 px-4 text-center text-dark/60 text-sm">
            <p>Â© 2023 ojopus.top | Memory Training Challenge</p>
        </footer>
    </div>

    <script>
        // Game state
        const gameState = {
            currentLevel: 1,
            totalLevels: 20,
            score: 0,
            currentNumber: '',
            isPlaying: false
        };

        // DOM Elements
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const endScreen = document.getElementById('end-screen');
        const startButton = document.getElementById('start-button');
        const restartButton = document.getElementById('restart-button');
        const homeButton = document.getElementById('home-button');
        const numberDisplay = document.getElementById('number-display');
        const inputArea = document.getElementById('input-area');
        const numberInput = document.getElementById('number-input');
        const submitButton = document.getElementById('submit-button');
        const feedback = document.getElementById('feedback');
        const nextButton = document.getElementById('next-button');
        const countdown = document.getElementById('countdown');
        const currentLevelEl = document.getElementById('current-level');
        const levelIndicators = document.getElementById('level-indicators');
        const scoreDisplay = document.getElementById('score-display');
        const currentScoreEl = document.getElementById('current-score');
        const finalScoreEl = document.getElementById('final-score');
        const ratingContainer = document.getElementById('rating-container');
        const ratingText = document.getElementById('rating-text');

        // Initialize level indicators
        function initializeLevelIndicators() {
            const container = levelIndicators.querySelector('div');
            container.innerHTML = '';
            
            for (let i = 1; i <= gameState.totalLevels; i++) {
                const indicator = document.createElement('div');
                indicator.id = `level-${i}`;
                indicator.className = 'w-6 h-6 rounded-full border-2 border-primary/30 flex-shrink-0 transition-all duration-300';
                container.appendChild(indicator);
            }
        }

        // Generate a random number with specified digits
        function generateRandomNumber(digits) {
            let min = 10 ** (digits - 1);
            let max = (10 ** digits) - 1;
            
            // For 1 digit, include 0
            if (digits === 1) {
                min = 0;
            }
            
            const number = Math.floor(Math.random() * (max - min + 1)) + min;
            return number.toString();
        }

        // Start the game
        function startGame() {
            // Reset game state
            gameState.currentLevel = 1;
            gameState.score = 0;
            gameState.isPlaying = true;
            
            // Update UI
            startScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            levelIndicators.classList.remove('hidden');
            scoreDisplay.classList.remove('hidden');
            currentScoreEl.textContent = gameState.score;
            
            // Start first level
            startLevel(gameState.currentLevel);
        }

        // Start a specific level
        function startLevel(level) {
            // Update UI
            currentLevelEl.textContent = level;
            numberDisplay.textContent = '';
            inputArea.classList.add('hidden');
            feedback.classList.add('hidden');
            nextButton.classList.add('hidden');
            numberInput.value = '';
            
            // Generate number with digits equal to level
            gameState.currentNumber = generateRandomNumber(level);
            
            // Show number after a short delay
            setTimeout(() => {
                numberDisplay.textContent = gameState.currentNumber;
                numberDisplay.classList.add('bounce-in');
                
                // Start countdown after number is displayed
                startCountdown(5);
            }, 500);
        }

        // Start countdown
        function startCountdown(seconds) {
            let count = seconds;
            countdown.textContent = count;
            countdown.classList.remove('hidden');
            
            const countdownInterval = setInterval(() => {
                count--;
                countdown.textContent = count;
                
                // Change color as time runs out
                if (count <= 2) {
                    countdown.classList.add('text-danger');
                    countdown.classList.remove('text-warning');
                }
                
                if (count <= 0) {
                    clearInterval(countdownInterval);
                    countdown.classList.add('hidden');
                    countdown.classList.remove('text-danger');
                    countdown.classList.add('text-warning');
                    numberDisplay.classList.remove('bounce-in');
                    numberDisplay.textContent = '';
                    showInputArea();
                }
            }, 1000);
        }

        // Show input area for user to enter number
        function showInputArea() {
            inputArea.classList.remove('hidden');
            numberInput.focus();
        }

        // Check user's answer
        function checkAnswer() {
            const userAnswer = numberInput.value.trim();
            const isCorrect = userAnswer === gameState.currentNumber;
            
            // Update score
            if (isCorrect) {
                const points = gameState.currentLevel * 5;
                gameState.score += points;
                currentScoreEl.textContent = gameState.score;
            }
            
            // Update level indicator
            const levelIndicator = document.getElementById(`level-${gameState.currentLevel}`);
            if (isCorrect) {
                levelIndicator.className = 'w-6 h-6 rounded-full bg-secondary border-2 border-secondary flex-shrink-0 transition-all duration-300';
                feedback.innerHTML = `<div class="text-secondary font-bold text-xl"><i class="fa fa-check-circle mr-2"></i> Correct!</div>
                                    <div class="text-dark/70">+${gameState.currentLevel * 5} points</div>`;
            } else {
                levelIndicator.className = 'w-6 h-6 rounded-full bg-danger border-2 border-danger flex-shrink-0 transition-all duration-300';
                feedback.innerHTML = `<div class="text-danger font-bold text-xl"><i class="fa fa-times-circle mr-2"></i> Incorrect</div>
                                    <div class="text-dark/70">The number was: ${gameState.currentNumber}</div>`;
            }
            
            // Show feedback
            inputArea.classList.add('hidden');
            feedback.classList.remove('hidden');
            
            // Check if game is finished
            if (gameState.currentLevel === gameState.totalLevels) {
                setTimeout(endGame, 2000);
            } else {
                nextButton.classList.remove('hidden');
            }
        }

        // Go to next level
        function nextLevel() {
            gameState.currentLevel++;
            startLevel(gameState.currentLevel);
        }

        // End the game and show results
        function endGame() {
            gameState.isPlaying = false;
            
            // Calculate rating
            let rating, ratingClass;
            if (gameState.score >= 840) {
                rating = 'Excellent!';
                ratingClass = 'bg-secondary/20 text-secondary border border-secondary/30';
            } else if (gameState.score >= 630) {
                rating = 'Very Good';
                ratingClass = 'bg-primary/20 text-primary border border-primary/30';
            } else if (gameState.score >= 420) {
                rating = 'Good';
                ratingClass = 'bg-warning/20 text-warning border border-warning/30';
            } else {
                rating = 'Keep Practicing';
                ratingClass = 'bg-gray-200 text-gray-700 border border-gray-300';
            }
            
            // Update UI
            gameScreen.classList.add('hidden');
            endScreen.classList.remove('hidden');
            finalScoreEl.textContent = gameState.score;
            ratingText.textContent = rating;
            ratingContainer.className = `mb-8 py-4 px-6 rounded-xl ${ratingClass}`;
        }

        // Restart the game
        function restartGame() {
            endScreen.classList.add('hidden');
            startGame();
        }

        // Return to home (parent page)
        function returnToHome() {
            if (window.parent && window.parent.postMessage) {
                window.parent.postMessage('returnToHome', '*');
            } else {
                // Fallback if in a standalone window
                alert('Would return to home page in a full implementation');
            }
        }

        // Event Listeners
        startButton.addEventListener('click', startGame);
        restartButton.addEventListener('click', restartGame);
        homeButton.addEventListener('click', returnToHome);
        submitButton.addEventListener('click', checkAnswer);
        nextButton.addEventListener('click', nextLevel);
        
        // Allow Enter key to submit answer
        numberInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                checkAnswer();
            }
        });

        // Handle window resize to ensure full screen
        function handleResize() {
            document.documentElement.style.height = `${window.innerHeight}px`;
        }

        // Initialize
        window.addEventListener('resize', handleResize);
        handleResize(); // Set initial size
        initializeLevelIndicators();
    </script>
</body>
</html>
